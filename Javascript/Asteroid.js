var asteroidImage;

var createAsteroidImage = function createAsteroidImage() {
   var bitmap = 
   [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 251, 251, 252, 255, 246, 247, 250, 255, 237, 238, 244, 255, 237, 239, 244, 255, 231, 232, 238, 255, 222, 223, 229, 255, 233, 234, 241, 255, 231, 232, 237, 255, 238, 240, 241, 255, 251, 251, 252, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 254, 254, 255, 248, 250, 252, 255, 238, 238, 244, 255, 221, 224, 235, 255, 209, 213, 224, 255, 195, 200, 209, 255, 187, 193, 202, 255, 154, 159, 171, 255, 119, 124, 138, 255, 109, 113, 130, 255, 141, 145, 161, 255, 136, 141, 158, 255, 162, 166, 184, 255, 189, 192, 204, 255, 222, 224, 228, 255, 247, 248, 249, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 248, 249, 249, 255, 236, 238, 244, 255, 223, 227, 242, 255, 210, 210, 214, 255, 201, 202, 202, 255, 191, 192, 193, 255, 158, 158, 163, 255, 120, 122, 136, 255, 98, 101, 121, 255, 90, 93, 116, 255, 105, 110, 129, 255, 123, 126, 146, 255, 133, 134, 156, 255, 128, 130, 146, 255, 141, 145, 158, 255, 158, 162, 177, 255, 163, 170, 184, 255, 194, 202, 212, 255, 228, 232, 238, 255, 251, 252, 253, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 245, 249, 251, 255, 226, 232, 232, 255, 228, 229, 229, 255, 203, 202, 213, 255, 192, 194, 196, 255, 194, 196, 194, 255, 166, 166, 171, 255, 139, 138, 152, 255, 139, 141, 156, 255, 117, 119, 138, 255, 113, 115, 135, 255, 114, 118, 131, 255, 150, 157, 166, 255, 121, 127, 145, 255, 87, 89, 111, 255, 136, 137, 155, 255, 163, 163, 174, 255, 160, 164, 174, 255, 119, 130, 145, 255, 86, 101, 131, 255, 108, 120, 154, 255, 196, 199, 211, 255, 254, 254, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 254, 254, 254, 255, 225, 234, 239, 255, 215, 219, 218, 255, 200, 200, 199, 255, 197, 198, 204, 255, 194, 195, 200, 255, 155, 156, 158, 255, 171, 171, 178, 255, 168, 166, 184, 255, 72, 77, 101, 255, 24, 29, 57, 255, 73, 76, 104, 255, 111, 113, 131, 255, 101, 106, 117, 255, 85, 91, 109, 255, 53, 54, 83, 255, 125, 126, 144, 255, 168, 169, 171, 255, 171, 170, 181, 255, 86, 86, 102, 255, 62, 62, 84, 255, 74, 74, 102, 255, 42, 41, 78, 255, 190, 185, 200, 255, 255, 254, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 250, 250, 251, 255, 207, 212, 221, 255, 183, 183, 187, 255, 193, 193, 196, 255, 163, 165, 173, 255, 128, 128, 134, 255, 164, 165, 170, 255, 178, 178, 186, 255, 135, 133, 153, 255, 9, 17, 53, 255, 11, 20, 63, 255, 18, 22, 62, 255, 140, 140, 168, 255, 102, 104, 128, 255, 107, 112, 138, 255, 132, 135, 152, 255, 175, 177, 187, 255, 168, 168, 175, 255, 161, 161, 177, 255, 116, 115, 140, 255, 72, 71, 101, 255, 78, 80, 106, 255, 21, 19, 59, 255, 77, 49, 81, 255, 212, 203, 213, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 240, 240, 244, 255, 187, 188, 201, 255, 178, 176, 187, 255, 189, 188, 195, 255, 184, 186, 193, 255, 181, 181, 188, 255, 173, 173, 178, 255, 145, 144, 155, 255, 128, 124, 147, 255, 27, 34, 67, 255, 32, 42, 74, 255, 50, 55, 81, 255, 198, 199, 216, 255, 89, 90, 115, 255, 72, 76, 106, 255, 179, 183, 186, 255, 172, 176, 177, 255, 150, 151, 168, 255, 136, 136, 157, 255, 63, 68, 104, 255, 22, 31, 70, 255, 21, 31, 64, 255, 18, 33, 65, 255, 37, 26, 59, 255, 103, 69, 91, 255, 238, 231, 235, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 230, 229, 237, 255, 191, 193, 206, 255, 198, 199, 209, 255, 212, 213, 217, 255, 208, 209, 209, 255, 200, 202, 207, 255, 193, 194, 197, 255, 166, 164, 171, 255, 152, 146, 164, 255, 103, 99, 128, 255, 109, 108, 129, 255, 169, 170, 181, 255, 181, 181, 192, 255, 94, 97, 120, 255, 104, 108, 133, 255, 180, 179, 185, 255, 147, 149, 155, 255, 135, 141, 158, 255, 81, 83, 111, 255, 6, 19, 67, 255, 6, 26, 66, 255, 31, 41, 78, 255, 29, 27, 67, 255, 39, 24, 70, 255, 60, 29, 58, 255, 162, 124, 147, 255, 254, 253, 253, 255, 0, 0, 0, 0, 0, 0, 0, 0],
   [254, 254, 254, 255, 222, 222, 232, 255, 178, 179, 190, 255, 195, 197, 211, 255, 181, 182, 201, 255, 105, 106, 130, 255, 106, 113, 133, 255, 147, 154, 164, 255, 171, 176, 182, 255, 152, 155, 163, 255, 130, 129, 147, 255, 126, 125, 143, 255, 123, 122, 139, 255, 126, 124, 144, 255, 99, 100, 127, 255, 76, 77, 105, 255, 159, 160, 176, 255, 118, 122, 134, 255, 137, 142, 158, 255, 83, 91, 120, 255, 16, 30, 77, 255, 8, 26, 64, 255, 14, 27, 64, 255, 40, 33, 72, 255, 38, 18, 66, 255, 34, 30, 63, 255, 75, 38, 64, 255, 217, 194, 203, 255, 0, 0, 0, 0, 0, 0, 0, 0],
   [251, 250, 251, 255, 205, 203, 211, 255, 193, 194, 203, 255, 185, 187, 203, 255, 26, 31, 62, 255, 16, 23, 62, 255, 13, 20, 65, 255, 41, 47, 81, 255, 47, 53, 77, 255, 66, 69, 93, 255, 115, 115, 135, 255, 135, 133, 155, 255, 139, 136, 160, 255, 152, 150, 173, 255, 115, 114, 139, 255, 44, 44, 75, 255, 60, 63, 93, 255, 64, 67, 90, 255, 130, 131, 145, 255, 134, 130, 147, 255, 82, 81, 111, 255, 126, 130, 149, 255, 159, 162, 186, 255, 70, 83, 110, 255, 37, 23, 58, 255, 50, 29, 66, 255, 62, 38, 53, 255, 161, 110, 122, 255, 252, 249, 251, 255, 0, 0, 0, 0],
   [250, 248, 249, 255, 176, 169, 175, 255, 184, 184, 193, 255, 95, 99, 116, 255, 23, 32, 58, 255, 16, 27, 60, 255, 20, 25, 60, 255, 58, 62, 88, 255, 87, 89, 110, 255, 116, 115, 141, 255, 71, 69, 96, 255, 63, 59, 91, 255, 78, 76, 106, 255, 138, 136, 155, 255, 96, 94, 112, 255, 28, 27, 60, 255, 14, 18, 59, 255, 63, 67, 97, 255, 150, 149, 163, 255, 151, 151, 168, 255, 92, 89, 115, 255, 135, 137, 153, 255, 99, 102, 127, 255, 42, 26, 66, 255, 42, 31, 47, 255, 69, 25, 54, 255, 88, 43, 68, 255, 154, 69, 84, 255, 234, 214, 219, 255, 0, 0, 0, 0],
   [251, 250, 251, 255, 166, 163, 173, 255, 190, 189, 199, 255, 92, 94, 115, 255, 97, 103, 127, 255, 109, 119, 137, 255, 110, 111, 128, 255, 132, 132, 152, 255, 129, 128, 149, 255, 156, 154, 175, 255, 64, 63, 87, 255, 57, 58, 95, 255, 92, 96, 117, 255, 150, 150, 160, 255, 76, 68, 94, 255, 28, 23, 56, 255, 11, 17, 49, 255, 30, 40, 68, 255, 89, 96, 120, 255, 89, 92, 114, 255, 55, 57, 82, 255, 52, 58, 91, 255, 40, 30, 65, 255, 58, 18, 58, 255, 64, 33, 61, 255, 68, 26, 50, 255, 112, 49, 66, 255, 166, 69, 80, 255, 224, 179, 183, 255, 0, 0, 0, 0],
   [0, 0, 0, 0, 198, 197, 203, 255, 197, 198, 206, 255, 134, 137, 152, 255, 127, 132, 148, 255, 125, 132, 143, 255, 115, 114, 129, 255, 139, 139, 152, 255, 150, 150, 161, 255, 173, 173, 184, 255, 40, 43, 70, 255, 44, 52, 91, 255, 78, 87, 114, 255, 122, 126, 145, 255, 34, 28, 61, 255, 26, 22, 56, 255, 11, 18, 48, 255, 9, 19, 48, 255, 18, 25, 56, 255, 66, 70, 100, 255, 59, 62, 92, 255, 31, 36, 76, 255, 40, 22, 59, 255, 74, 37, 69, 255, 79, 40, 68, 255, 92, 40, 60, 255, 134, 55, 64, 255, 185, 81, 81, 255, 233, 182, 177, 255, 0, 0, 0, 0],
   [0, 0, 0, 0, 203, 206, 213, 255, 189, 193, 202, 255, 144, 148, 157, 255, 139, 144, 152, 255, 122, 126, 135, 255, 137, 136, 149, 255, 171, 171, 176, 255, 175, 176, 177, 255, 189, 190, 196, 255, 24, 28, 61, 255, 26, 35, 74, 255, 38, 49, 84, 255, 43, 47, 83, 255, 22, 19, 55, 255, 20, 18, 54, 255, 15, 22, 54, 255, 13, 21, 53, 255, 13, 16, 51, 255, 44, 46, 85, 255, 37, 36, 70, 255, 27, 26, 67, 255, 50, 25, 58, 255, 78, 36, 62, 255, 87, 39, 61, 255, 119, 52, 65, 255, 161, 69, 67, 255, 215, 110, 95, 255, 235, 190, 179, 255, 0, 0, 0, 0],
   [0, 0, 0, 0, 179, 185, 197, 255, 154, 161, 178, 255, 129, 135, 144, 255, 164, 165, 174, 255, 158, 156, 170, 255, 163, 163, 171, 255, 180, 182, 180, 255, 199, 201, 203, 255, 160, 158, 178, 255, 14, 13, 54, 255, 72, 78, 109, 255, 13, 18, 58, 255, 20, 19, 66, 255, 26, 23, 59, 255, 17, 20, 57, 255, 11, 18, 53, 255, 18, 23, 59, 255, 18, 16, 55, 255, 24, 17, 60, 255, 32, 21, 55, 255, 39, 25, 59, 255, 80, 40, 64, 255, 106, 50, 69, 255, 120, 53, 71, 255, 147, 64, 69, 255, 179, 81, 65, 255, 227, 137, 110, 255, 247, 220, 210, 255, 0, 0, 0, 0],
   [0, 0, 0, 0, 191, 198, 212, 255, 122, 134, 163, 255, 102, 108, 124, 255, 81, 81, 96, 255, 164, 163, 183, 255, 183, 186, 191, 255, 198, 201, 207, 255, 163, 165, 181, 255, 45, 46, 78, 255, 25, 24, 65, 255, 91, 94, 125, 255, 21, 22, 61, 255, 34, 26, 72, 255, 28, 26, 61, 255, 3, 13, 50, 255, 4, 14, 52, 255, 17, 20, 58, 255, 30, 22, 61, 255, 38, 21, 62, 255, 52, 27, 58, 255, 55, 28, 58, 255, 86, 40, 58, 255, 115, 50, 70, 255, 129, 62, 76, 255, 162, 73, 69, 255, 200, 103, 91, 255, 245, 187, 148, 255, 254, 246, 240, 255, 0, 0, 0, 0],
   [0, 0, 0, 0, 240, 242, 245, 255, 86, 106, 139, 255, 81, 91, 120, 255, 68, 70, 92, 255, 90, 93, 114, 255, 113, 118, 128, 255, 69, 74, 97, 255, 11, 19, 55, 255, 7, 19, 58, 255, 14, 22, 61, 255, 37, 40, 78, 255, 27, 26, 64, 255, 34, 27, 65, 255, 19, 19, 57, 255, 7, 19, 60, 255, 8, 18, 61, 255, 25, 24, 64, 255, 39, 25, 60, 255, 48, 25, 64, 255, 68, 32, 63, 255, 68, 34, 65, 255, 79, 36, 61, 255, 105, 39, 58, 255, 128, 61, 71, 255, 179, 83, 72, 255, 220, 139, 116, 255, 248, 231, 201, 255, 255, 255, 254, 255, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 207, 214, 224, 255, 46, 62, 97, 255, 67, 75, 105, 255, 85, 87, 112, 255, 149, 154, 176, 255, 52, 61, 96, 255, 3, 18, 65, 255, 1, 20, 67, 255, 5, 19, 61, 255, 8, 16, 56, 255, 18, 21, 60, 255, 27, 26, 64, 255, 25, 21, 62, 255, 20, 19, 65, 255, 20, 20, 67, 255, 30, 25, 66, 255, 43, 30, 65, 255, 53, 28, 70, 255, 74, 36, 68, 255, 76, 40, 74, 255, 81, 36, 62, 255, 128, 54, 64, 255, 168, 75, 79, 255, 223, 124, 105, 255, 241, 203, 146, 255, 254, 253, 247, 255, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 234, 236, 240, 255, 51, 65, 100, 255, 14, 25, 61, 255, 39, 50, 86, 255, 8, 19, 65, 255, 4, 18, 69, 255, 3, 20, 65, 255, 3, 20, 62, 255, 5, 18, 59, 255, 11, 20, 60, 255, 20, 24, 63, 255, 23, 23, 64, 255, 22, 22, 68, 255, 25, 24, 71, 255, 32, 24, 66, 255, 46, 29, 64, 255, 69, 35, 72, 255, 91, 44, 72, 255, 83, 39, 69, 255, 96, 41, 62, 255, 165, 77, 77, 255, 219, 121, 104, 255, 242, 180, 143, 255, 245, 243, 214, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 226, 229, 235, 255, 135, 144, 166, 255, 52, 64, 102, 255, 7, 19, 69, 255, 12, 21, 68, 255, 9, 15, 52, 255, 2, 18, 57, 255, 1, 17, 59, 255, 8, 20, 61, 255, 12, 20, 59, 255, 9, 16, 56, 255, 6, 17, 59, 255, 13, 17, 62, 255, 30, 21, 62, 255, 54, 31, 66, 255, 79, 37, 66, 255, 101, 44, 66, 255, 93, 39, 62, 255, 113, 49, 63, 255, 188, 92, 86, 255, 235, 149, 110, 255, 244, 221, 172, 255, 252, 254, 251, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 253, 253, 253, 255, 205, 209, 218, 255, 76, 90, 122, 255, 7, 19, 60, 255, 2, 17, 59, 255, 2, 16, 60, 255, 4, 18, 60, 255, 5, 17, 59, 255, 3, 18, 60, 255, 0, 15, 58, 255, 10, 14, 57, 255, 43, 25, 59, 255, 76, 41, 66, 255, 92, 45, 67, 255, 95, 39, 65, 255, 93, 44, 59, 255, 144, 65, 72, 255, 204, 107, 97, 255, 242, 185, 138, 255, 253, 248, 229, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 248, 249, 251, 255, 100, 115, 144, 255, 2, 20, 66, 255, 1, 17, 62, 255, 4, 17, 59, 255, 6, 17, 57, 255, 4, 17, 58, 255, 1, 15, 59, 255, 18, 21, 64, 255, 53, 33, 67, 255, 71, 34, 57, 255, 80, 30, 53, 255, 86, 28, 62, 255, 117, 53, 73, 255, 195, 106, 98, 255, 241, 159, 121, 255, 253, 235, 222, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 254, 254, 255, 182, 190, 205, 255, 37, 57, 103, 255, 5, 22, 68, 255, 3, 16, 59, 255, 5, 19, 61, 255, 3, 17, 62, 255, 19, 22, 65, 255, 42, 23, 56, 255, 59, 26, 52, 255, 66, 41, 69, 255, 128, 58, 73, 255, 191, 95, 89, 255, 234, 163, 130, 255, 252, 235, 219, 255, 255, 255, 254, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 240, 243, 247, 255, 143, 154, 180, 255, 36, 51, 96, 255, 20, 36, 79, 255, 13, 27, 70, 255, 20, 24, 67, 255, 51, 33, 66, 255, 93, 51, 76, 255, 149, 83, 102, 255, 189, 137, 134, 255, 229, 197, 195, 255, 253, 247, 247, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 255, 247, 248, 250, 255, 232, 234, 240, 255, 207, 209, 220, 255, 221, 219, 225, 255, 237, 231, 234, 255, 249, 246, 247, 255, 255, 254, 254, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]];
   
   asteroidImage = createImage(30, 25);
   asteroidImage.loadPixels();

   for (var x = 0; x < asteroidImage.width; x++) {
      for (var y = 0; y < asteroidImage.height; y++) {
         var red   = bitmap[y][x * 4 + 0];
         var green = bitmap[y][x * 4 + 1];
         var blue  = bitmap[y][x * 4 + 2];
         var alpha = bitmap[y][x * 4 + 3];
		asteroidImage.set(x, y, color(red, green, blue, alpha));
      }
   }

   asteroidImage.updatePixels();
};

var Asteroid = function Asteroid(startPosition, endPosition) {
   var movementPerSecond = 150;
   var millisPerSecond   = 1000;
   var x = startPosition.x;
   var y = startPosition.y;
   var distance = getDistance(startPosition, endPosition);
   var flightTimeInMillis = (distance / movementPerSecond) * millisPerSecond;
   var distanceX = endPosition.x - startPosition.x;
	var distanceY = endPosition.y - startPosition.y;
	var xIncrementPerMilli = distanceX / flightTimeInMillis;
	var yIncrementPerMilli = distanceY / flightTimeInMillis;
	var heading = Math.atan(distanceX / Math.max(0, (distanceY * -1)));
   
   var lastDistance;
   var lastDrawTime = Date.now();
   var state = 'flying';
   var explosionDiameter = 2;
   var explosionColor = {r: 255, g: 156, b:12};

   this.id = nextMissileId++;
   
   if (asteroidImage === undefined) {
      createAsteroidImage();
   }

   var drawAsteroidImage = function drawAsteroidImage() {
		push();
		translate(x, y);
		rotate(heading);
		image(asteroidImage, -4, -4);
		pop();
   };

   var drawExplosion = function drawExplosion() {
      var colorToUse = color(explosionColor.r, explosionColor.g, explosionColor.b);
      stroke(colorToUse);
      fill(colorToUse);
      arc(endPosition.x, endPosition.y, explosionDiameter, explosionDiameter, 0, 2 * 3.1415);
      if (explosionDiameter > 40) {
         state = 'delete';
      }
      explosionColor.r = explosionColor.r - 15;
      explosionColor.g = explosionColor.g + 15;
      explosionDiameter = explosionDiameter * 2;
   };

   this.draw = function draw() {
      var currentTime = Date.now();
      var millisSinceLastDraw = currentTime - lastDrawTime;
      
      var distance = getDistance({x: x, y: y}, endPosition);
      if (state === 'flying' && (lastDistance === undefined || distance < lastDistance)) {
         drawAsteroidImage();
         x = x + (xIncrementPerMilli * millisSinceLastDraw);
         y = y + (yIncrementPerMilli * millisSinceLastDraw);
         lastDistance = distance;
      } else {
         if (state === 'flying') {
            state = 'exploding';
         }
         if (state === 'exploding') {
            drawExplosion();
         }
         if (state === 'delete') {
            missiles = missiles.filter(missile => missile.id !== this.id);
         }
      }

      lastDrawTime = currentTime;
   };
};